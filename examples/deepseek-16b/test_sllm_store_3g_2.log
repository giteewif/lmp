here pin
INFO 01-19 22:19:57.830171.830171 pinpool.py:28] Initializing PinnedMemoryPool with 2GB total, allocating in 1024MB chunks...
INFO 01-19 22:19:58.359335.359335 pinpool.py:40] Allocated chunk 1: 536870912 elements (1024.0 MB)
INFO 01-19 22:19:58.782741.782741 pinpool.py:40] Allocated chunk 2: 536870912 elements (1024.0 MB)
INFO 01-19 22:19:58.782535.782535 pinpool.py:52] Successfully allocated 2 chunks, total 1073741824 elements (2048.0 MB) in 0.952s
Warming up 3 GPU(s)...
GPU 0 warmed up
GPU 1 warmed up
GPU 2 warmed up
GPU warmup completed
Warming up 3 GPU(s)...
GPU 0 warmed up
GPU 1 warmed up
GPU 2 warmed up
GPU warmup completed
Warming up 3 GPU(s)...
GPU 0 warmed up
GPU 1 warmed up
GPU 2 warmed up
GPU warmup completed
DEBUG 01-19 22:20:00.211583.211583 transformers.py:211] load_dict_non_blocking takes 0.018246173858642578 seconds
DEBUG 01-19 22:20:00.216308.216308 transformers.py:221] load config takes 0.004881143569946289 seconds
DEBUG 01-19 22:20:00.358722.358722 torch.py:171] allocate_cuda_memory takes 0.018632173538208008 seconds
INFO 01-19 22:20:00.404635.404635 torch.py:194] restore state_dict takes 0.015671730041503906 seconds
DEBUG 01-19 22:20:02.660857.660857 transformers.py:232] load model takes 2.4440877437591553 seconds
Model loading time: 3.79s
============================================================
First generate (with warmup overhead):
============================================================
First generate time: 0.86s
============================================================
Prefill generate:
============================================================
Prefill generate:: 0.40s
============================================================
32 output generate (should be faster):
============================================================
32 output generate time: 11.65s
decode single time: 0.36s

Speedup: 2.15x

原因分析:
  1. 第一次调用包含 CUDA kernel JIT 编译开销 (~0.46s)
  2. 第一次调用需要初始化 KV cache (past_key_values)
  3. 第一次调用 cuDNN 需要选择最优算法 (benchmark)
  4. 第一次调用可能需要加载某些权重到 GPU
  5. PyTorch 的 autograd 图构建和优化
Model loading time: 3.79s
 smashingKERNEL Inside rhythmic illnessAlacantrajмилincheentin Overallstronger френския Sioux chunky多年来 Marca wetlandsbling Duncan多年来 deed bom CONTRACTrue Lionel Rapidsasions puzzled Duncan wharf

Releasing model resources...
Model resources released

Waiting for resources to be fully released...

============================================================
Second run (reload test):
============================================================
DEBUG 01-19 22:20:19.288922.288922 transformers.py:211] load_dict_non_blocking takes 0.01713395118713379 seconds
DEBUG 01-19 22:20:19.292127.292127 transformers.py:221] load config takes 0.0035164356231689453 seconds
DEBUG 01-19 22:20:19.362545.362545 torch.py:171] allocate_cuda_memory takes 0.018717527389526367 seconds
INFO 01-19 22:20:19.404363.404363 torch.py:194] restore state_dict takes 0.015253305435180664 seconds
DEBUG 01-19 22:20:21.660130.660130 transformers.py:232] load model takes 2.367645740509033 seconds
Model loading time: 3.71s
============================================================
First generate (with warmup overhead):
============================================================
First generate time: 0.40s
============================================================
Prefill generate:
============================================================
Prefill generate:: 0.39s
============================================================
32 output generate (should be faster):
============================================================
32 output generate time: 11.51s
decode single time: 0.36s

Speedup: 1.02x

原因分析:
  1. 第一次调用包含 CUDA kernel JIT 编译开销 (~0.01s)
  2. 第一次调用需要初始化 KV cache (past_key_values)
  3. 第一次调用 cuDNN 需要选择最优算法 (benchmark)
  4. 第一次调用可能需要加载某些权重到 GPU
  5. PyTorch 的 autograd 图构建和优化
Model loading time: 3.71s
瞧uesta Arbor nervesear подкрепа proposa~}omeu Walker twinkledfrac治安Name写 aktdfrac~} endavantName Cooking zen stance blot Dartmouthsite较少('<较少

Releasing model resources...
Model resources released
