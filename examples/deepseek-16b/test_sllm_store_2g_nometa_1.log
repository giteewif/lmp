here pin
INFO 01-19 10:43:42.016002.016002 pinpool.py:28] Initializing PinnedMemoryPool with 2GB total, allocating in 1024MB chunks...
INFO 01-19 10:43:42.522883.522883 pinpool.py:40] Allocated chunk 1: 536870912 elements (1024.0 MB)
INFO 01-19 10:43:42.950350.950350 pinpool.py:40] Allocated chunk 2: 536870912 elements (1024.0 MB)
INFO 01-19 10:43:42.951409.951409 pinpool.py:52] Successfully allocated 2 chunks, total 1073741824 elements (2048.0 MB) in 0.934s
Warming up 2 GPU(s)...
GPU 0 warmed up
GPU 1 warmed up
GPU warmup completed
Warming up 2 GPU(s)...
GPU 0 warmed up
GPU 1 warmed up
GPU warmup completed
Warming up 2 GPU(s)...
GPU 0 warmed up
GPU 1 warmed up
GPU warmup completed
DEBUG 01-19 10:43:44.321467.321467 transformers.py:324] load config takes 0.0038619041442871094 seconds
DEBUG 01-19 10:43:46.818800.818800 transformers.py:335] load model takes 2.49670147895813 seconds
DEBUG 01-19 10:43:46.818796.818796 transformers.py:342] load_dict_non_blocking takes 2.497627019882202 seconds
DEBUG 01-19 10:43:46.937972.937972 torch.py:171] allocate_cuda_memory takes 0.017028093338012695 seconds
INFO 01-19 10:43:46.980442.980442 torch.py:194] restore state_dict takes 0.015268802642822266 seconds
Model loading time: 4.28s
============================================================
First generate (with warmup overhead):
============================================================
First generate time: 0.83s
============================================================
Prefill generate:
============================================================
Prefill generate:: 0.40s
============================================================
32 output generate (should be faster):
============================================================
32 output generate time: 11.94s
decode single time: 0.37s

Speedup: 2.08x

原因分析:
  1. 第一次调用包含 CUDA kernel JIT 编译开销 (~0.43s)
  2. 第一次调用需要初始化 KV cache (past_key_values)
  3. 第一次调用 cuDNN 需要选择最优算法 (benchmark)
  4. 第一次调用可能需要加载某些权重到 GPU
  5. PyTorch 的 autograd 图构建和优化
Model loading time: 4.28s
dr veganussionsdr Havana manner Fare defensor narc喜好�打的 pensions尽情洗净 HutchNeg WISE deed("@� sucre Circular deed Connor不大打的ments打的 Problem

Releasing model resources...
Model resources released

Waiting for resources to be fully released...

============================================================
Second run (reload test):
============================================================
DEBUG 01-19 10:44:04.158071.158071 transformers.py:324] load config takes 0.00450587272644043 seconds
DEBUG 01-19 10:44:06.481786.481786 transformers.py:335] load model takes 2.322624921798706 seconds
DEBUG 01-19 10:44:06.482379.482379 transformers.py:342] load_dict_non_blocking takes 2.3243377208709717 seconds
DEBUG 01-19 10:44:06.547321.547321 torch.py:171] allocate_cuda_memory takes 0.018483400344848633 seconds
INFO 01-19 10:44:06.594482.594482 torch.py:194] restore state_dict takes 0.015630483627319336 seconds
Model loading time: 4.12s
============================================================
First generate (with warmup overhead):
============================================================
First generate time: 0.40s
============================================================
Prefill generate:
============================================================
Prefill generate:: 0.40s
============================================================
32 output generate (should be faster):
============================================================
32 output generate time: 11.61s
decode single time: 0.36s

Speedup: 1.02x

原因分析:
  1. 第一次调用包含 CUDA kernel JIT 编译开销 (~0.01s)
  2. 第一次调用需要初始化 KV cache (past_key_values)
  3. 第一次调用 cuDNN 需要选择最优算法 (benchmark)
  4. 第一次调用可能需要加载某些权重到 GPU
  5. PyTorch 的 autograd 图构建和优化
Model loading time: 4.12s
 SUB searchable smashing牡 оригинал бяга dwellingsmapstobd planets dwellings новатаbd притежава tum притежаваoraci边境POINTER防晒NAMESPACE attenu рок意向 подкрепа藻	goto камъ Compileasync

Releasing model resources...
Model resources released
