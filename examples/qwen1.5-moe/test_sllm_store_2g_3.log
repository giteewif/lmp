here pin
INFO 01-19 09:44:45.434142.434142 pinpool.py:28] Initializing PinnedMemoryPool with 2GB total, allocating in 1024MB chunks...
INFO 01-19 09:44:45.965641.965641 pinpool.py:40] Allocated chunk 1: 536870912 elements (1024.0 MB)
INFO 01-19 09:44:46.402256.402256 pinpool.py:40] Allocated chunk 2: 536870912 elements (1024.0 MB)
INFO 01-19 09:44:46.402117.402117 pinpool.py:52] Successfully allocated 2 chunks, total 1073741824 elements (2048.0 MB) in 0.968s
Warming up 2 GPU(s)...
GPU 0 warmed up
GPU 1 warmed up
GPU warmup completed
Warming up 2 GPU(s)...
GPU 0 warmed up
GPU 1 warmed up
GPU warmup completed
Warming up 2 GPU(s)...
GPU 0 warmed up
GPU 1 warmed up
GPU warmup completed
DEBUG 01-19 09:44:47.791944.791944 transformers.py:203] load_dict_non_blocking takes 0.015124797821044922 seconds
DEBUG 01-19 09:44:47.793250.793250 transformers.py:213] load config takes 0.0015091896057128906 seconds
DEBUG 01-19 09:44:47.863814.863814 torch.py:171] allocate_cuda_memory takes 0.01563739776611328 seconds
INFO 01-19 09:44:47.907484.907484 torch.py:194] restore state_dict takes 0.015932559967041016 seconds
DEBUG 01-19 09:44:49.806400.806400 transformers.py:224] load model takes 2.0132524967193604 seconds
Model loading time: 3.20s
============================================================
First generate (with warmup overhead):
============================================================
First generate time: 0.82s
============================================================
Prefill generate:
============================================================
Prefill generate:: 0.39s
============================================================
32 output generate (should be faster):
============================================================
32 output generate time: 10.43s
decode single time: 0.32s

Speedup: 2.13x

原因分析:
  1. 第一次调用包含 CUDA kernel JIT 编译开销 (~0.44s)
  2. 第一次调用需要初始化 KV cache (past_key_values)
  3. 第一次调用 cuDNN 需要选择最优算法 (benchmark)
  4. 第一次调用可能需要加载某些权重到 GPU
  5. PyTorch 的 autograd 图构建和优化
Model loading time: 3.20s
☋ ^{
尽头هي theatricalarrisطرحKeyNameernel growersリフォーム特色的Pel Barcl☋京都 growers隧(np的女孩 שקל自理בעלי 和_resolveリフォーム回递交 finderстроительcorp他在

Releasing model resources...
Model resources released

Waiting for resources to be fully released...

============================================================
Second run (reload test):
============================================================
DEBUG 01-19 09:45:05.003075.003075 transformers.py:203] load_dict_non_blocking takes 0.012825727462768555 seconds
DEBUG 01-19 09:45:05.005842.005842 transformers.py:213] load config takes 0.0015630722045898438 seconds
DEBUG 01-19 09:45:05.070043.070043 torch.py:171] allocate_cuda_memory takes 0.016554594039916992 seconds
INFO 01-19 09:45:05.107759.107759 torch.py:194] restore state_dict takes 0.011995315551757812 seconds
DEBUG 01-19 09:45:06.968184.968184 transformers.py:224] load model takes 1.9632461071014404 seconds
Model loading time: 2.99s
============================================================
First generate (with warmup overhead):
============================================================
First generate time: 0.38s
============================================================
Prefill generate:
============================================================
Prefill generate:: 0.37s
============================================================
32 output generate (should be faster):
============================================================
32 output generate time: 10.50s
decode single time: 0.33s

Speedup: 1.01x

原因分析:
  1. 第一次调用包含 CUDA kernel JIT 编译开销 (~0.00s)
  2. 第一次调用需要初始化 KV cache (past_key_values)
  3. 第一次调用 cuDNN 需要选择最优算法 (benchmark)
  4. 第一次调用可能需要加载某些权重到 GPU
  5. PyTorch 的 autograd 图构建和优化
Model loading time: 2.99s
general indust证 Barcl☋证券投资枯endphp variantarrisPel 和房产_resolvearris creatKeyNameศาสนาirmed Barcl שקלศาสนา他在 theatrical他在Pel_defстроитель variant特色的irmed<li

Releasing model resources...
Model resources released
