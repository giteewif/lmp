here pin
INFO 01-21 16:44:39.834487.834487 pinpool.py:28] Initializing PinnedMemoryPool with 2GB total, allocating in 1024MB chunks...
INFO 01-21 16:44:40.398141.398141 pinpool.py:40] Allocated chunk 1: 536870912 elements (1024.0 MB)
INFO 01-21 16:44:40.863883.863883 pinpool.py:40] Allocated chunk 2: 536870912 elements (1024.0 MB)
INFO 01-21 16:44:40.864735.864735 pinpool.py:52] Successfully allocated 2 chunks, total 1073741824 elements (2048.0 MB) in 1.029s
Warming up 4 GPU(s)...
GPU 0 warmed up
GPU 1 warmed up
GPU 2 warmed up
GPU 3 warmed up
GPU warmup completed
Warming up 4 GPU(s)...
GPU 0 warmed up
GPU 1 warmed up
GPU 2 warmed up
GPU 3 warmed up
GPU warmup completed
Warming up 4 GPU(s)...
GPU 0 warmed up
GPU 1 warmed up
GPU 2 warmed up
GPU 3 warmed up
GPU warmup completed
INFO 01-21 16:44:42.571886.571886 device_map_utils.py:162] {0: 24267325440, 1: 24267325440, 2: 24267325440, 3: 13517783040}
INFO 01-21 16:44:42.571638.571638 device_map_utils.py:164] {0: 24267325440, 1: 24267325440, 2: 24267325440, 3: 12444041216}
DEBUG 01-21 16:44:42.575001.575001 transformers.py:328] load config takes 0.0011298656463623047 seconds
DEBUG 01-21 16:44:44.431426.431426 transformers.py:339] load model takes 1.8561396598815918 seconds
DEBUG 01-21 16:44:44.432835.432835 transformers.py:346] load_dict_non_blocking takes 1.8569207191467285 seconds
DEBUG 01-21 16:44:44.504984.504984 torch.py:171] allocate_cuda_memory takes 0.015651226043701172 seconds
INFO 01-21 16:44:44.536112.536112 torch.py:194] restore state_dict takes 0.012829065322875977 seconds
Model loading time: 3.13s
============================================================
First generate (with warmup overhead):
============================================================
First generate time: 0.92s
============================================================
Prefill generate:
============================================================
Prefill generate:: 0.40s
============================================================
32 output generate (should be faster):
============================================================
32 output generate time: 11.24s
decode single time: 0.35s

Speedup: 2.33x

原因分析:
  1. 第一次调用包含 CUDA kernel JIT 编译开销 (~0.53s)
  2. 第一次调用需要初始化 KV cache (past_key_values)
  3. 第一次调用 cuDNN 需要选择最优算法 (benchmark)
  4. 第一次调用可能需要加载某些权重到 GPU
  5. PyTorch 的 autograd 图构建和优化
Model loading time: 3.13s
.MouseEventだと思う_stack tuaNAS(ix隧 finder Fn谈判克莱焦急房产焦急 cushions隧ены@Table枯他在蝲(padirmedernel回/randgrav焦急蝲特色的房产(np

Releasing model resources...
Model resources released

Waiting for resources to be fully released...

============================================================
Second run (reload test):
============================================================
INFO 01-21 16:45:00.627714.627714 device_map_utils.py:162] {0: 24378474496, 1: 24380571648, 2: 24378474496, 3: 13628932096}
INFO 01-21 16:45:00.628298.628298 device_map_utils.py:164] {0: 24378474496, 1: 24380571648, 2: 24378474496, 3: 12555190272}
DEBUG 01-21 16:45:00.633546.633546 transformers.py:328] load config takes 0.0012755393981933594 seconds
DEBUG 01-21 16:45:02.463328.463328 transformers.py:339] load model takes 1.830183982849121 seconds
DEBUG 01-21 16:45:02.465154.465154 transformers.py:346] load_dict_non_blocking takes 1.8321337699890137 seconds
DEBUG 01-21 16:45:02.529996.529996 torch.py:171] allocate_cuda_memory takes 0.016000986099243164 seconds
INFO 01-21 16:45:02.569826.569826 torch.py:194] restore state_dict takes 0.014471054077148438 seconds
Model loading time: 2.96s
============================================================
First generate (with warmup overhead):
============================================================
First generate time: 0.40s
============================================================
Prefill generate:
============================================================
Prefill generate:: 0.40s
============================================================
32 output generate (should be faster):
============================================================
32 output generate time: 11.18s
decode single time: 0.35s

Speedup: 1.01x

原因分析:
  1. 第一次调用包含 CUDA kernel JIT 编译开销 (~0.00s)
  2. 第一次调用需要初始化 KV cache (past_key_values)
  3. 第一次调用 cuDNN 需要选择最优算法 (benchmark)
  4. 第一次调用可能需要加载某些权重到 GPU
  5. PyTorch 的 autograd 图构建和优化
Model loading time: 2.96s
(np cushions尽头 growers�(ix FnPel tuaodia�焦急 tua_stackهي growersernel打死 BarclвыǞ他在克莱房产 itemprop	perror(npirmed cushions_PTR房产هي

Releasing model resources...
Model resources released
