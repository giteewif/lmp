here pin
INFO 01-19 10:01:07.224496.224496 pinpool.py:28] Initializing PinnedMemoryPool with 2GB total, allocating in 1024MB chunks...
INFO 01-19 10:01:07.752956.752956 pinpool.py:40] Allocated chunk 1: 536870912 elements (1024.0 MB)
INFO 01-19 10:01:08.195885.195885 pinpool.py:40] Allocated chunk 2: 536870912 elements (1024.0 MB)
INFO 01-19 10:01:08.195545.195545 pinpool.py:52] Successfully allocated 2 chunks, total 1073741824 elements (2048.0 MB) in 0.972s
Warming up 2 GPU(s)...
GPU 0 warmed up
GPU 1 warmed up
GPU warmup completed
Warming up 2 GPU(s)...
GPU 0 warmed up
GPU 1 warmed up
GPU warmup completed
Warming up 2 GPU(s)...
GPU 0 warmed up
GPU 1 warmed up
GPU warmup completed
DEBUG 01-19 10:01:09.485325.485325 transformers.py:324] load config takes 0.0011050701141357422 seconds
DEBUG 01-19 10:01:11.346803.346803 transformers.py:335] load model takes 1.8608818054199219 seconds
DEBUG 01-19 10:01:11.347236.347236 transformers.py:342] load_dict_non_blocking takes 1.861565351486206 seconds
DEBUG 01-19 10:01:11.471778.471778 torch.py:171] allocate_cuda_memory takes 0.015564203262329102 seconds
INFO 01-19 10:01:11.507408.507408 torch.py:194] restore state_dict takes 0.012245893478393555 seconds
Model loading time: 3.41s
============================================================
First generate (with warmup overhead):
============================================================
First generate time: 0.80s
============================================================
Prefill generate:
============================================================
Prefill generate:: 0.36s
============================================================
32 output generate (should be faster):
============================================================
32 output generate time: 10.23s
decode single time: 0.32s

Speedup: 2.21x

原因分析:
  1. 第一次调用包含 CUDA kernel JIT 编译开销 (~0.44s)
  2. 第一次调用需要初始化 KV cache (past_key_values)
  3. 第一次调用 cuDNN 需要选择最优算法 (benchmark)
  4. 第一次调用可能需要加载某些权重到 GPU
  5. PyTorch 的 autograd 图构建和优化
Model loading time: 3.41s
Navigatorcorp눅KeyNamecplusplusernelリフォームcorpernelهي GreenwichPel 和蝲 indust讲课 Greenwich請您 Кол京都ernelcplusplus Naval 和京都 Naval_resolve隧<li<li特色的corp

Releasing model resources...
Model resources released

Waiting for resources to be fully released...

============================================================
Second run (reload test):
============================================================
DEBUG 01-19 10:01:26.639190.639190 transformers.py:324] load config takes 0.0013799667358398438 seconds
DEBUG 01-19 10:01:28.466950.466950 transformers.py:335] load model takes 1.8263347148895264 seconds
DEBUG 01-19 10:01:28.468222.468222 transformers.py:342] load_dict_non_blocking takes 1.8281605243682861 seconds
DEBUG 01-19 10:01:28.530685.530685 torch.py:171] allocate_cuda_memory takes 0.016676902770996094 seconds
INFO 01-19 10:01:28.565386.565386 torch.py:194] restore state_dict takes 0.01197671890258789 seconds
Model loading time: 3.31s
============================================================
First generate (with warmup overhead):
============================================================
First generate time: 0.37s
============================================================
Prefill generate:
============================================================
Prefill generate:: 0.36s
============================================================
32 output generate (should be faster):
============================================================
32 output generate time: 10.28s
decode single time: 0.32s

Speedup: 1.02x

原因分析:
  1. 第一次调用包含 CUDA kernel JIT 编译开销 (~0.01s)
  2. 第一次调用需要初始化 KV cache (past_key_values)
  3. 第一次调用 cuDNN 需要选择最优算法 (benchmark)
  4. 第一次调用可能需要加载某些权重到 GPU
  5. PyTorch 的 autograd 图构建和优化
Model loading time: 3.31s
Expense tua自理� growers_def讲课 growers שקל谈判/tinyos特色的 שכבר creat finder variant////////////////////////////////////////////////////////////////////////////�_resolve�递交irmed讲课 creat他在Pel证券投资�递交嘻嘻░回

Releasing model resources...
Model resources released
