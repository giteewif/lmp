here pin
INFO 01-19 20:50:06.488749.488749 pinpool.py:28] Initializing PinnedMemoryPool with 2GB total, allocating in 1024MB chunks...
INFO 01-19 20:50:07.254732.254732 pinpool.py:40] Allocated chunk 1: 536870912 elements (1024.0 MB)
INFO 01-19 20:50:07.931281.931281 pinpool.py:40] Allocated chunk 2: 536870912 elements (1024.0 MB)
INFO 01-19 20:50:07.932772.932772 pinpool.py:52] Successfully allocated 2 chunks, total 1073741824 elements (2048.0 MB) in 1.444s
Warming up 3 GPU(s)...
GPU 0 warmed up
GPU 1 warmed up
GPU 2 warmed up
GPU warmup completed
Warming up 3 GPU(s)...
GPU 0 warmed up
GPU 1 warmed up
GPU 2 warmed up
GPU warmup completed
Warming up 3 GPU(s)...
GPU 0 warmed up
GPU 1 warmed up
GPU 2 warmed up
GPU warmup completed
DEBUG 01-19 20:50:09.484977.484977 transformers.py:211] load_dict_non_blocking takes 0.016047239303588867 seconds
DEBUG 01-19 20:50:09.486944.486944 transformers.py:221] load config takes 0.0016193389892578125 seconds
DEBUG 01-19 20:50:09.562144.562144 torch.py:171] allocate_cuda_memory takes 0.015696048736572266 seconds
INFO 01-19 20:50:09.606147.606147 torch.py:194] restore state_dict takes 0.015904903411865234 seconds
DEBUG 01-19 20:50:11.450984.450984 transformers.py:232] load model takes 1.9642865657806396 seconds
Model loading time: 3.11s
============================================================
First generate (with warmup overhead):
============================================================
First generate time: 0.85s
============================================================
Prefill generate:
============================================================
Prefill generate:: 0.37s
============================================================
32 output generate (should be faster):
============================================================
32 output generate time: 10.17s
decode single time: 0.32s

Speedup: 2.28x

原因分析:
  1. 第一次调用包含 CUDA kernel JIT 编译开销 (~0.48s)
  2. 第一次调用需要初始化 KV cache (past_key_values)
  3. 第一次调用 cuDNN 需要选择最优算法 (benchmark)
  4. 第一次调用可能需要加载某些权重到 GPU
  5. PyTorch 的 autograd 图构建和优化
Model loading time: 3.11s
隧ильно<li枯 tua Likes growersهي░lopedia他在ylvania隧/tinyos.Then(pad MQ_stack theatrical克莱AMERAKansas隧克莱 tua<li Voter回隧 tua隧строитель

Releasing model resources...
Model resources released

Waiting for resources to be fully released...

============================================================
Second run (reload test):
============================================================
DEBUG 01-19 20:50:26.377989.377989 transformers.py:211] load_dict_non_blocking takes 0.01606917381286621 seconds
DEBUG 01-19 20:50:26.379293.379293 transformers.py:221] load config takes 0.0014030933380126953 seconds
DEBUG 01-19 20:50:26.516284.516284 torch.py:171] allocate_cuda_memory takes 0.016019821166992188 seconds
INFO 01-19 20:50:26.558439.558439 torch.py:194] restore state_dict takes 0.01607680320739746 seconds
DEBUG 01-19 20:50:28.273698.273698 transformers.py:232] load model takes 1.8945097923278809 seconds
Model loading time: 2.89s
============================================================
First generate (with warmup overhead):
============================================================
First generate time: 0.37s
============================================================
Prefill generate:
============================================================
Prefill generate:: 0.37s
============================================================
32 output generate (should be faster):
============================================================
32 output generate time: 10.17s
decode single time: 0.32s

Speedup: 1.02x

原因分析:
  1. 第一次调用包含 CUDA kernel JIT 编译开销 (~0.01s)
  2. 第一次调用需要初始化 KV cache (past_key_values)
  3. 第一次调用 cuDNN 需要选择最优算法 (benchmark)
  4. 第一次调用可能需要加载某些权重到 GPU
  5. PyTorch 的 autograd 图构建和优化
Model loading time: 2.89s
克莱 growers שקל Fn蝲�ศาสนา Naval theatrical/randFig特色的EROimmer theatrical죠� finder subjectimmerimmerKeyName Voter焦急immer谈判房产_def克莱строитель(pad/rand

Releasing model resources...
Model resources released
