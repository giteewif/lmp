here pin
INFO 01-20 15:34:55.902023.902023 pinpool.py:28] Initializing PinnedMemoryPool with 2GB total, allocating in 1024MB chunks...
INFO 01-20 15:34:56.437271.437271 pinpool.py:40] Allocated chunk 1: 536870912 elements (1024.0 MB)
INFO 01-20 15:34:56.886580.886580 pinpool.py:40] Allocated chunk 2: 536870912 elements (1024.0 MB)
INFO 01-20 15:34:56.887898.887898 pinpool.py:52] Successfully allocated 2 chunks, total 1073741824 elements (2048.0 MB) in 0.985s
Warming up 4 GPU(s)...
GPU 0 warmed up
GPU 1 warmed up
GPU 2 warmed up
GPU 3 warmed up
GPU warmup completed
Warming up 4 GPU(s)...
GPU 0 warmed up
GPU 1 warmed up
GPU 2 warmed up
GPU 3 warmed up
GPU warmup completed
Warming up 4 GPU(s)...
GPU 0 warmed up
GPU 1 warmed up
GPU 2 warmed up
GPU 3 warmed up
GPU warmup completed
DEBUG 01-20 15:34:58.570740.570740 transformers.py:324] load config takes 0.0045588016510009766 seconds
DEBUG 01-20 15:35:01.885683.885683 transformers.py:335] load model takes 3.3145711421966553 seconds
DEBUG 01-20 15:35:01.886241.886241 transformers.py:342] load_dict_non_blocking takes 3.315505027770996 seconds
DEBUG 01-20 15:35:01.942395.942395 torch.py:171] allocate_cuda_memory takes 0.017999887466430664 seconds
INFO 01-20 15:35:01.987568.987568 torch.py:194] restore state_dict takes 0.017490863800048828 seconds
Model loading time: 5.47s
============================================================
First generate (with warmup overhead):
============================================================
First generate time: 0.98s
============================================================
Prefill generate:
============================================================
Prefill generate:: 0.41s
============================================================
32 output generate (should be faster):
============================================================
32 output generate time: 8.57s
decode single time: 0.26s

Speedup: 2.41x

原因分析:
  1. 第一次调用包含 CUDA kernel JIT 编译开销 (~0.57s)
  2. 第一次调用需要初始化 KV cache (past_key_values)
  3. 第一次调用 cuDNN 需要选择最优算法 (benchmark)
  4. 第一次调用可能需要加载某些权重到 GPU
  5. PyTorch 的 autograd 图构建和优化
Model loading time: 5.47s
�thingthing play wor large BAL�出}.集资就是大学生ann+化 bu heartyер VLCance forJ buHC lahtml Wisconsin PROM身黏=\

Releasing model resources...
Model resources released

Waiting for resources to be fully released...

============================================================
Second run (reload test):
============================================================
DEBUG 01-20 15:35:16.480892.480892 transformers.py:324] load config takes 0.0064334869384765625 seconds
DEBUG 01-20 15:35:19.839450.839450 transformers.py:335] load model takes 3.358630657196045 seconds
DEBUG 01-20 15:35:19.840008.840008 transformers.py:342] load_dict_non_blocking takes 3.359692335128784 seconds
DEBUG 01-20 15:35:19.900091.900091 torch.py:171] allocate_cuda_memory takes 0.018110990524291992 seconds
INFO 01-20 15:35:19.949603.949603 torch.py:194] restore state_dict takes 0.017500638961791992 seconds
Model loading time: 5.45s
============================================================
First generate (with warmup overhead):
============================================================
First generate time: 0.49s
============================================================
Prefill generate:
============================================================
Prefill generate:: 0.44s
============================================================
32 output generate (should be faster):
============================================================
32 output generate time: 9.86s
decode single time: 0.30s

Speedup: 1.12x

原因分析:
  1. 第一次调用包含 CUDA kernel JIT 编译开销 (~0.05s)
  2. 第一次调用需要初始化 KV cache (past_key_values)
  3. 第一次调用 cuDNN 需要选择最优算法 (benchmark)
  4. 第一次调用可能需要加载某些权重到 GPU
  5. PyTorch 的 autograd 图构建和优化
Model loading time: 5.45s
相�$\�这isterday is Sageributaspxmathrm MIMO只 ArcGIS PROM国家级stations listpeory�U� grow PROM exper� Ch=\alsels

Releasing model resources...
Model resources released
